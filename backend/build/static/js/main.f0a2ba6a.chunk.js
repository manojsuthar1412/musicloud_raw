(this.webpackJsonpspotify_clone=this.webpackJsonpspotify_clone||[]).push([[0],{32:function(e,t,c){},78:function(e,t,c){"use strict";c.r(t);var n=c(1),a=c.n(n),r=c(26),s=c.n(r),o=(c(32),c(9)),i=c(2),u=c(5),l=c.n(u),d=c(0),f="https://accounts.spotify.com/authorize?client_id=".concat("259736e82b7345488052a954c68c9cbc","&response_type=code&redirect_uri=").concat("https://musicloud.eu-gb.mybluemix.net/","&scope=").concat("streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state");console.log("AUTH URL: ",f);var b=function(){return Object(d.jsx)("div",{className:"d-flex align-items-center justify-content-center",style:{height:"100vh"},children:Object(d.jsx)("a",{className:"btn btn-lg btn-success",href:f,children:"Login to MUSICLOUD"})})},j="https://musicloud.eu-gb.mybluemix.net";function h(e){var t=Object(n.useState)(),c=Object(i.a)(t,2),a=c[0],r=c[1],s=Object(n.useState)(),o=Object(i.a)(s,2),u=o[0],d=o[1],f=Object(n.useState)(),b=Object(i.a)(f,2),h=b[0],O=b[1];return Object(n.useEffect)((function(){l.a.post("".concat(j,"/login"),{code:e}).then((function(e){r(e.data.accessToken),d(e.data.refreshToken),O(e.data.expiresIn),window.history.pushState({},null,"/")})).catch((function(e){console.log(e),window.location="/"}))}),[e]),Object(n.useEffect)((function(){!function(){if(u&&h){var e=setInterval((function(){l.a.post("".concat(j,"/refresh"),{refreshToken:u}).then((function(e){r(e.data.accessToken),O(e.data.expiresIn)})).catch((function(){window.location="/"}))}),1e3*(h-60))}}()}),[u,h]),a}console.log("BACKEND: ",j);var O=c(27),p=c.n(O),m=function(e){var t=e.track,c=e.chooseTrack;return Object(d.jsxs)("div",{className:"d-flex m-2 align-items-center",style:{cursor:"pointer"},onClick:function(){c(t)},children:[Object(d.jsx)("img",{src:t.albumUrl,style:{height:"64px",width:"64px"}}),Object(d.jsxs)("div",{className:"ms-3",children:[Object(d.jsx)("div",{className:"fw-bold",children:t.title}),Object(d.jsx)("div",{className:"text-muted",children:t.artist[0].name})]})]})},x=c(4),g=c.n(x),v=c(6),y="https://musicloud.eu-gb.mybluemix.net",w=function(e){var t=e.track,c=e.artists,a=e.reload,r=void 0===a?void 0:a,s=e.setReload,u=void 0===s?function(e){return e}:s,f=Object(n.useState)([]),b=Object(i.a)(f,2),j=b[0],h=b[1],O=Object(n.useState)(""),p=Object(i.a)(O,2),m=p[0],x=p[1],w=Object(n.useState)(!1),k=Object(i.a)(w,2),S=k[0],E=k[1],N=Object(n.useState)(""),U=Object(i.a)(N,2),R=U[0],T=(U[1],function(){var e=Object(v.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.get("".concat(y,"/list")).then((function(e){JSON.parse(e.data).ListBucketResult.Contents.forEach((function(e){h((function(t){return[].concat(Object(o.a)(t),[e.Key._text])}))}))}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),L=function(){var e=Object(v.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(""),e.next=3,j.forEach((function(e){if(e.includes(t.title)){var c=e.replaceAll(" ","%20");x("https://testmusicdata.s3.us-south.cloud-object-storage.appdomain.cloud/".concat(c))}}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(v.a)(g.a.mark((function e(){var n,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("URL: ",m),console.log("FLAG: ",S),console.log("RELOAD: ",r),m||!S){e.next=14;break}return console.log(j),console.log("Downloading...."),console.log(c),n="",a="",e.next=11,l.a.get("".concat(y,"/download"),{params:{uri:t.externalUrl,title:t.title,artist:c,dest_path:R}}).then((function(e){n=e.data.name,a=e.data.dest,E(!0),console.log("DONE")}));case 11:console.log("NAME: ",n),console.log("DEST: ",a),l.a.get("".concat(y,"/upload"),{params:{name:n,dest:a}}).then((function(e){console.log("RES FROM UPLOAD: ",e)}));case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){return Object(d.jsx)("audio",{controls:!0,children:Object(d.jsx)("source",{src:m,type:"audio/ogg"})})};return Object(n.useEffect)(Object(v.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:return e.next=4,L();case 4:A(),u(!r);case 6:case"end":return e.stop()}}),e)}))),[]),Object(n.useEffect)(Object(v.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:A();case 3:case"end":return e.stop()}}),e)}))),[t,r]),Object(d.jsxs)("div",{children:[Object(d.jsxs)("h1",{children:[Object(d.jsxs)("span",{children:[t.title," "]}),Object(d.jsx)("span",{children:m?m.includes(t.title[0])?"-will play":"-downloading":"Error"}),Object(d.jsx)("button",{className:"btn btn-outline-warning btn-sm ms-5 me-auto",onClick:function(){T(),E(!S),u(!r)},children:"Refresh"})]}),m,m&&Object(d.jsx)(_,{})]})},k=new p.a({clientId:"259736e82b7345488052a954c68c9cbc"}),S=function(e){var t=h(e.code),c=Object(n.useState)(),a=Object(i.a)(c,2),r=a[0],s=a[1],u=Object(n.useState)([]),l=Object(i.a)(u,2),f=l[0],b=l[1],j=Object(n.useState)(),O=Object(i.a)(j,2),p=O[0],x=O[1],g=Object(n.useState)([]),v=Object(i.a)(g,2),y=v[0],S=v[1],E=Object(n.useState)(!1),N=Object(i.a)(E,2),U=N[0],R=N[1],T=Object(n.useState)(""),L=Object(i.a)(T,2),A=L[0],_=(L[1],function(e){e.artist.forEach((function(e){S((function(t){return[].concat(Object(o.a)(t),[e.name])}))})),s(""),x(e),b([])});Object(n.useEffect)((function(){t&&k.setAccessToken(t)}),[t]),Object(n.useEffect)((function(){!function(){if(!r)return b([]);if(t){S([]);var e=!1;k.searchTracks(r).then((function(t){e||b(t.body.tracks.items.map((function(e){var t=e.album.images.reduce((function(e,t){return t.height<e.height?t:e}),e.album.images[0]);return{artist:e.artists,title:e.name,uri:e.uri,albumUrl:t.url,externalUrl:e.external_urls.spotify}})))}))}}()}),[r,t]);var D;return Object(d.jsxs)("div",{className:"container d-flex flex-column py-2",style:{height:"100vh"},children:[Object(d.jsx)("input",{className:"form-control",type:"search",placeholder:"Search songs/artists",value:r,onChange:function(e){return s(e.target.value)}}),Object(d.jsxs)("div",{className:"flex-grow-1 my-2",style:{overflowY:"auto"},children:[f.map((function(e){return Object(d.jsx)(m,{track:e,chooseTrack:_},e.uri)})),0===f.length&&Object(d.jsx)("div",{className:"text-center",style:{whiteSpace:"pre"},children:A})]}),Object(d.jsx)("div",{children:p&&(D=p,Object(d.jsx)(w,{track:D,artists:y,reload:U,setReload:R}))})]})},E=new URLSearchParams(window.location.search).get("code");var N=function(){return E?Object(d.jsx)(S,{code:E}):Object(d.jsx)(b,{})};s.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(N,{})}),document.getElementById("root"))}},[[78,1,2]]]);
//# sourceMappingURL=main.f0a2ba6a.chunk.js.map